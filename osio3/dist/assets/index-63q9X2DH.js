var c={};const i=require("express"),u=require("morgan"),p=require("path"),t=i(),l=require("cors");u.token("postData",n=>{const{name:e,number:s,...r}=n.body;return JSON.stringify({name:e,number:s,...r})});t.use(i.json());t.use(u(":method :url :status :response-time ms - :postData"));t.use(l());let o=[{name:"Arto Hellas",number:"040-123456",id:1},{name:"Ada Lovelace",number:"39-44-5323523",id:2},{name:"Dan Abramov",number:"12-43-234345",id:3},{name:"Mary Poppendieck",number:"39-23-6423122",id:4}];t.get("/api/persons",(n,e)=>{e.json(o)});const g=()=>(o.length>0?Math.max(...o.map(e=>e.id)):0)+1;t.post("/api/persons",(n,e)=>{const{name:s,number:r}=n.body;if(!s||!r)return e.status(400).json({error:"name or number missing"});if(o.some(d=>d.name===s))return e.status(400).json({error:"name must be unique"});const a={name:s,number:r,id:g()};o=o.concat(a),e.json(a)});t.get("/api/persons/:id",(n,e)=>{const s=Number(n.params.id),r=o.find(a=>a.id===s);r?e.json(r):e.status(404).end()});t.delete("/api/persons/:id",(n,e)=>{const s=Number(n.params.id);o=o.filter(r=>r.id!==s),e.status(204).end()});t.get("/info",(n,e)=>{const s=`<p>Phonebook has info for ${o.length} people</p>`,r=new Date().toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"});e.send(`${s}<p>${r}</p>`)});t.use(i.static("dist"));t.get("*",(n,e)=>{e.sendFile(p.join(__dirname,"dist","index.html"))});const m=c.PORT||3001;t.listen(m,()=>{console.log(`Server running on port ${m}`)});
